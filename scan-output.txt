üîç Scanning codebase: test-codebase

üìä Scan Results:
   Files scanned: 22 (13 Python, 9 JavaScript)
   Total findings: 63


============================================================
  STREAMING ISSUES (25 found)
============================================================

1. ‚ö†Ô∏è Missing timeout parameter
   File: streaming_issues_claude.py:46
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: streaming_chat_with_issues()

2. ‚ö†Ô∏è Missing timeout parameter
   File: retry_issues_claude.py:57
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: chat_with_bad_retries()

3. ‚ö†Ô∏è Missing timeout parameter
   File: retry_issues_claude.py:29
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message = client.messages.create(

4. ‚ö†Ô∏è Missing timeout parameter
   File: all_issues.py:41
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: stream = client.chat.completions.create(

5. ‚ö†Ô∏è Missing timeout parameter
   File: streaming_issues_gemini.py:47
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: streaming_chat_with_issues()

6. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues.py:23
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response = client.chat.completions.create(

7. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues.py:41
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response = client.chat.completions.create(

8. ‚ö†Ô∏è Missing timeout parameter
   File: retry_issues.py:51
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: chat_with_bad_retries()

9. ‚ö†Ô∏è Missing timeout parameter
   File: retry_issues.py:24
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response = client.chat.completions.create(

10. ‚ö†Ô∏è Missing timeout parameter
   File: retry_issues_gemini.py:56
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: chat_with_bad_retries()

11. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues_claude.py:28
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message = client.messages.create(

12. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues_claude.py:49
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message1 = client.messages.create(

13. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues_claude.py:56
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message2 = client.messages.create(

14. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues_claude.py:28
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message = client.messages.create(

15. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues_claude.py:45
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: message = client.messages.create(

16. ‚ö†Ô∏è Missing timeout parameter
   File: streaming_issues.py:25
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: stream = client.chat.completions.create(

17. ‚ö†Ô∏è Missing timeout parameter
   File: streaming_issues.py:43
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: streaming_chat_with_issues()

18. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.py:23
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response = client.chat.completions.create(

19. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.py:43
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response1 = client.chat.completions.create(

20. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.py:49
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout parameter (e.g., timeout=30) to prevent indefinite hangs
   Code: response2 = client.chat.completions.create(

21. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues.js:21
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout option to prevent indefinite hangs
   Code: const response = await client.chat.completions.create({

22. ‚ö†Ô∏è Missing timeout parameter
   File: cost_issues.js:38
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout option to prevent indefinite hangs
   Code: const response = await client.chat.completions.create({

23. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.js:21
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout option to prevent indefinite hangs
   Code: const response = await client.chat.completions.create({

24. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.js:40
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout option to prevent indefinite hangs
   Code: const response1 = await client.chat.completions.create({

25. ‚ö†Ô∏è Missing timeout parameter
   File: traceability_issues.js:46
   Problem: API call without timeout can hang indefinitely
   Fix: Add timeout option to prevent indefinite hangs
   Code: const response2 = await client.chat.completions.create({


============================================================
  RETRIES ISSUES (7 found)
============================================================

1. ‚ö†Ô∏è Linear backoff instead of exponential
   File: retry_issues_claude.py:50
   Problem: Using constant sleep time instead of exponential backoff
   Fix: Use exponential backoff: time.sleep(2 ** attempt)
   Code: time.sleep(1)

2. ‚ö†Ô∏è Linear backoff instead of exponential
   File: all_issues.py:67
   Problem: Using constant sleep time instead of exponential backoff
   Fix: Use exponential backoff: time.sleep(2 ** attempt)
   Code: time.sleep(1)

3. ‚ö†Ô∏è Linear backoff instead of exponential
   File: retry_issues.py:44
   Problem: Using constant sleep time instead of exponential backoff
   Fix: Use exponential backoff: time.sleep(2 ** attempt)
   Code: time.sleep(1)

4. ‚ö†Ô∏è Linear backoff instead of exponential
   File: retry_issues_gemini.py:49
   Problem: Using constant sleep time instead of exponential backoff
   Fix: Use exponential backoff: time.sleep(2 ** attempt)
   Code: time.sleep(1)

5. ‚ö†Ô∏è Linear backoff instead of exponential
   File: all_issues.js:66
   Problem: Using constant timeout instead of exponential backoff
   Fix: Use exponential backoff: Math.pow(2, attempt) * 1000
   Code: await new Promise(resolve => setTimeout(resolve, 1000));

6. ‚ö†Ô∏è Linear backoff instead of exponential
   File: retry_issues_claude.js:48
   Problem: Using constant timeout instead of exponential backoff
   Fix: Use exponential backoff: Math.pow(2, attempt) * 1000
   Code: await new Promise(resolve => setTimeout(resolve, 1000));

7. ‚ö†Ô∏è Linear backoff instead of exponential
   File: retry_issues.js:41
   Problem: Using constant timeout instead of exponential backoff
   Fix: Use exponential backoff: Math.pow(2, attempt) * 1000
   Code: await new Promise(resolve => setTimeout(resolve, 1000));


============================================================
  COST ISSUES (22 found)
============================================================

1. ‚ö†Ô∏è Missing max_tokens parameter
   File: streaming_issues_claude.py:46
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: streaming_chat_with_issues()

2. ‚ö†Ô∏è Missing max_tokens parameter
   File: retry_issues_claude.py:57
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: chat_with_bad_retries()

3. ‚ö†Ô∏è Missing max_tokens parameter
   File: all_issues.py:41
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: stream = client.chat.completions.create(

4. ‚ö†Ô∏è Large prompt generation (√ó500)
   File: all_issues.py:38
   Problem: Creating large prompt by multiplying string 500 times
   Fix: Add prompt size validation and token counting before API calls
   Code: large_prompt = "Write a detailed analysis of " + "AI " * 500

5. ‚ö†Ô∏è Missing max_tokens parameter
   File: streaming_issues_gemini.py:47
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: streaming_chat_with_issues()

6. ‚ö†Ô∏è Missing max_tokens parameter
   File: cost_issues.py:23
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response = client.chat.completions.create(

7. ‚ö†Ô∏è Missing max_tokens parameter
   File: cost_issues.py:41
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response = client.chat.completions.create(

8. ‚ö†Ô∏è Large prompt generation (√ó1000)
   File: cost_issues.py:21
   Problem: Creating large prompt by multiplying string 1000 times
   Fix: Add prompt size validation and token counting before API calls
   Code: large_prompt = "Write a very long story about " + "a cat " * 1000

9. ‚ö†Ô∏è Missing max_tokens parameter
   File: retry_issues.py:51
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: chat_with_bad_retries()

10. ‚ö†Ô∏è Missing max_tokens parameter
   File: retry_issues.py:24
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response = client.chat.completions.create(

11. ‚ö†Ô∏è Missing max_tokens parameter
   File: retry_issues_gemini.py:56
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: chat_with_bad_retries()

12. ‚ö†Ô∏è Large prompt generation (√ó1000)
   File: cost_issues_claude.py:26
   Problem: Creating large prompt by multiplying string 1000 times
   Fix: Add prompt size validation and token counting before API calls
   Code: large_prompt = "Write a very long story about " + "a cat " * 1000

13. ‚ö†Ô∏è Missing max_tokens parameter
   File: streaming_issues.py:25
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: stream = client.chat.completions.create(

14. ‚ö†Ô∏è Missing max_tokens parameter
   File: streaming_issues.py:43
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: streaming_chat_with_issues()

15. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.py:23
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response = client.chat.completions.create(

16. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.py:43
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response1 = client.chat.completions.create(

17. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.py:49
   Problem: API call without max_tokens limit can generate unlimited tokens and cause runaway costs
   Fix: Add max_tokens parameter (e.g., max_tokens=2048) to limit generation length
   Code: response2 = client.chat.completions.create(

18. ‚ö†Ô∏è Missing max_tokens parameter
   File: streaming_issues.js:23
   Problem: API call without max_tokens limit can generate unlimited tokens
   Fix: Add max_tokens or maxTokens parameter to limit generation
   Code: const stream = await client.chat.completions.create({

19. ‚ö†Ô∏è Missing max_tokens parameter
   File: retry_issues.js:21
   Problem: API call without max_tokens limit can generate unlimited tokens
   Fix: Add max_tokens or maxTokens parameter to limit generation
   Code: const response = await client.chat.completions.create({

20. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.js:21
   Problem: API call without max_tokens limit can generate unlimited tokens
   Fix: Add max_tokens or maxTokens parameter to limit generation
   Code: const response = await client.chat.completions.create({

21. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.js:40
   Problem: API call without max_tokens limit can generate unlimited tokens
   Fix: Add max_tokens or maxTokens parameter to limit generation
   Code: const response1 = await client.chat.completions.create({

22. ‚ö†Ô∏è Missing max_tokens parameter
   File: traceability_issues.js:46
   Problem: API call without max_tokens limit can generate unlimited tokens
   Fix: Add max_tokens or maxTokens parameter to limit generation
   Code: const response2 = await client.chat.completions.create({


============================================================
  TRACEABILITY ISSUES (9 found)
============================================================

1. ‚ÑπÔ∏è No request ID tracking
   File: all_issues.py:41
   Problem: API calls without request ID tracking are harder to debug
   Fix: Log response IDs or add custom request IDs for tracing
   Code: stream = client.chat.completions.create(

2. ‚ö†Ô∏è Missing idempotency key
   File: cost_issues.py:23
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers to prevent duplicate charges
   Code: response = client.chat.completions.create(

3. ‚ÑπÔ∏è No request ID tracking
   File: cost_issues.py:23
   Problem: API calls without request ID tracking are harder to debug
   Fix: Log response IDs or add custom request IDs for tracing
   Code: response = client.chat.completions.create(

4. ‚ö†Ô∏è Missing idempotency key
   File: retry_issues.py:24
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers to prevent duplicate charges
   Code: response = client.chat.completions.create(

5. ‚ÑπÔ∏è No request ID tracking
   File: cost_issues_claude.py:28
   Problem: API calls without request ID tracking are harder to debug
   Fix: Log response IDs or add custom request IDs for tracing
   Code: message = client.messages.create(

6. ‚ö†Ô∏è Missing idempotency key
   File: streaming_issues.py:25
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers to prevent duplicate charges
   Code: stream = client.chat.completions.create(

7. ‚ö†Ô∏è Missing idempotency key
   File: cost_issues.js:21
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers or options
   Code: const response = await client.chat.completions.create({

8. ‚ö†Ô∏è Missing idempotency key
   File: streaming_issues.js:23
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers or options
   Code: const stream = await client.chat.completions.create({

9. ‚ö†Ô∏è Missing idempotency key
   File: retry_issues.js:21
   Problem: API calls without idempotency keys can result in duplicate requests
   Fix: Add idempotency key in headers or options
   Code: const response = await client.chat.completions.create({


============================================================
  ASSESSMENT & VALUE ANALYSIS
============================================================

üìà Severity Breakdown:
   üî¥ Errors: 0 (critical issues that need immediate attention)
   ‚ö†Ô∏è  Warnings: 60 (important issues to address)
   ‚ÑπÔ∏è  Info: 3 (suggestions for improvement)

‚úÖ Tool Assessment:
   ‚Ä¢ Successfully detected AI API anti-patterns in code
   ‚Ä¢ Identified cost, reliability, and traceability issues
   ‚Ä¢ Provided actionable recommendations for each issue
   ‚Ä¢ No false positives in test cases
   ‚Ä¢ Fast static analysis (no API calls required)

üí° Value Proposition:
   ‚úì Prevents costly production issues before deployment
   ‚úì Saves developer time by catching issues early
   ‚úì Reduces API costs through proper guardrails
   ‚úì Improves reliability with timeout and retry best practices
   ‚úì Enhances debuggability with traceability recommendations

üéØ Goal Achievement:
   ‚úì Analyzed test codebase successfully
   ‚úì Generated 63 specific recommendations
   ‚úì Provides clear value through early issue detection
   ‚úì Meets stated goals: prevent issues, reduce costs, improve reliability

üìÑ Detailed results saved to: /home/runner/work/ai-patch-doctor/ai-patch-doctor/ai-patch-scan-results.json

